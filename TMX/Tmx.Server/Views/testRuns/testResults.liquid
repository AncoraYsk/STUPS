<html>
	<head>
		<title>Test results</title>
	</head>
	<body>
        <a href="/">Home</a>
        <br>
        <br>
        <!-- <h1>Overall status is {{ overallStatus }}</h1> -->
        <!-- <ul> -->
        {% assign overallStatus = '<h1>NOT TESTED</h1>' %}
        
        <h1>{{ @Model.TestRun.Name }} /{{ @Model.TestRun.Status }}/</h1>
        
        <!--
        <h2>Summary</h2>
        <table border="1">
            <tr>
                <th>Story</th>
                <th>Platform</th>
                <th colspan=4>Results</th>
                <th>Time spent</th>
            </tr>
            {% for suite in @Model.TestRun.TestSuites -%}
            <tr>
                <td>{{ suite.Name }}</td>
                <td>{{ suite.PlatformId }}</td>
                <td width={{ suite.Statistics.Passed / suite.Statistics.All }}% color="green">{{ suite.Statistics.Passed }}</td>
                <td width={{ suite.Statistics.Failed / suite.Statistics.All }}% color="red">{{ suite.Statistics.Failed }}</td>
                <td width={{ suite.Statistics.PassedButWithBadSmell / suite.Statistics.All }}% color="olive">{{ suite.Statistics.PassedButWithBadSmell }}</td>
                <td width={{ suite.Statistics.NotTested / suite.Statistics.All }}% color="gray">{{ suite.Statistics.NotTested }}</td>
                <td>{{ suite.Statistics.TimeSpent }}</td>
            </tr>
            {% endfor -%}
        </table>
        <br>
        <br>
        <h2>Detailed report</h2>
        -->
        
        <h2>Summary</h2>
        <table border="1">
            <tr>
                <th>Story</th>
                <th>Platform</th>
                <th colspan=4>Results</th>
                <th>Time spent</th>
            </tr>
            {% assign sortedTestSuites = @Model.Suites | sort: 'name', 'platformId', 'timestamp' %}
            {% for suite in sortedTestSuites %}
            <tr>
                <td>{{ suite.Name }}</td>
                <td>{{ suite.PlatformId }}</td>
                <td width={{ suite.Statistics.Passed / suite.Statistics.All }}% color="green">{{ suite.Statistics.Passed }}</td>
                <td width={{ suite.Statistics.Failed / suite.Statistics.All }}% color="red">{{ suite.Statistics.Failed }}</td>
                <td width={{ suite.Statistics.PassedButWithBadSmell / suite.Statistics.All }}% color="olive">{{ suite.Statistics.PassedButWithBadSmell }}</td>
                <td width={{ suite.Statistics.NotTested / suite.Statistics.All }}% color="gray">{{ suite.Statistics.NotTested }}</td>
                <td>{{ suite.Statistics.TimeSpent }}</td>
            </tr>
            {% endfor %}
        </table>
        <br>
        <br>
        <h2>Detailed report</h2>
        
        <ul>
        {% for suite in @Model.TestRun.TestSuites -%}
            {% if suite.Name != 'autogenerated' %}
                {% case suite.Status %}
                {% when 'PASSED' %}
                    {% assign suiteColor = 'green' %}
                {% when 'FAILED' %}
                    {% assign suiteColor = 'red' %}
                {% when 'NOT TESTED' %}
                    {% assign suiteColor = 'gray' %}
                {% endcase %}
                <li><font color="{{ suiteColor }}">{{ suite.Id }} {{ suite.Name }} {{ suite.PlatformId }}</font></li>
            {% endif %}
            <ul>
            {% for scenario in suite.TestScenarios -%}
                {% if scenario.Name != 'autogenerated' %}
                    {% case scenario.Status %}
                    {% when 'PASSED' %}
                        {% assign scenarioColor = 'green' %}
                    {% when 'FAILED' %}
                        {% assign scenarioColor = 'red' %}
                    {% when 'NOT TESTED' %}
                        {% assign scenarioColor = 'gray' %}
                    {% endcase %}
                    <li><font color="{{ scenarioColor }}">{{ scenario.Id }} {{ scenario.Name }} {{ scenario.PlatformId }}</font></li>
                {% endif %}
                <ul>
                {% assign sortedTestResults = scenario.TestResults | sort: 'Timestamp' %}
                {% for result in sortedTestResults -%}
                    {% if result.Origin == 'Logical' %}
                        {% case result.Status %}
                        {% when 'PASSED' %}
                            {% assign resultColor = 'green' %}
                        {% when 'FAILED' %}
                            {% assign resultColor = 'red' %}
                        {% when 'NOT TESTED' %}
                            {% assign resultColor = 'gray' %}
                        {% when 'KNOWN ISSUE' %}
                            {% assign resultColor = 'olive' %}
                        {% endcase %}
                        <li><font color="{{ resultColor }}">{{ result.Id }} {{ result.Name }}</font></li>
                    {% endif %}
                {% endfor -%}
                </ul>
            {% endfor -%}
            </ul>
        {% endfor -%}
        </ul>
    </body>
</html>